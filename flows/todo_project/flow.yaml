flow: TodoManager
description: Manage user todo items

inputs:
  - name: user_id
    type: string
    required: true
  - name: action
    type: string
    required: true
  - name: todo_data
    type: object
    required: false

steps:
  - task: ValidateUser
    id: validate
    inputs:
      user_id: ${inputs.user_id}
    outputs:
      - is_valid

  - task: CreateTodo
    id: create
    if: ${validate.is_valid} and ${inputs.action} == 'create'
    inputs:
      user_id: ${inputs.user_id}
      title: ${inputs.todo_data.title}
      description: ${inputs.todo_data.description}
      slug: ${inputs.todo_data.slug}
    outputs:
      - todo_id

  - task: GetTodos
    id: get
    if: ${validate.is_valid} and ${inputs.action} == 'list'
    inputs:
      user_id: ${inputs.user_id}
    outputs:
      - todos

  - task: SendNotification
    id: notify
    if: ${create.todo_id}
    inputs:
      user_id: ${inputs.user_id}
      message: ${create.todo_id}

  - task: LogInvalidAction
    id: log_invalid
    if: not ${validate.is_valid}
    inputs:
      user_id: ${inputs.user_id}
      action: ${inputs.action}

outputs:
  - name: success
    value: ${validate.is_valid}
  - name: result
    value: ${create.todo_id or get.todos}
